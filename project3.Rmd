---
title: "project3"
author: "Group6"
date: "3/25/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
setwd("/Users/candicelin/Desktop/TO 414/Absenteeism_at_work_AAA")
absent <-read.csv("Absenteeism_at_work.csv")
str(absent)
absent$ID <- as.factor(absent$ID)
absent$Reason.for.absence <- as.factor(absent$Reason.for.absence)
absent$Month.of.absence <- as.factor(absent$Month.of.absence)
absent$Day.of.the.week <- as.factor(absent$Day.of.the.week)
absent$Seasons <- as.factor(absent$Season)
absent$Disciplinary.failure <-as.factor(absent$Disciplinary.failure)
absent$Education <- as.factor(absent$Education)
absent$Social.drinker <-as.factor(absent$Social.drinker)
absent$Social.smoker <-as.factor(absent$Social.smoker)
absent$ID <- NULL
##absent$Reason.for.absence<-NULL
##absent$Month.of.absence <- NULL
lm1 <-lm(Absenteeism.time.in.hours ~.,data=absent)
summary(lm1)
# ANN/Decision tree/Logistic Rminer?
```

## ANN Model
```{r}
#Dividing response variable into categories 
absent$timecat <- absent$Absenteeism.time.in.hours
absent$timecat <- ifelse(absent$timecat==0, "Not Absent", 
                         ifelse(absent$timecat>0 & absent$timecat<8, "<1 day", 
                                ifelse(absent$timecat>=8 & absent$timecat<=32, "1-4 days", 
                                       ifelse(absent$timecat>32 & absent$timecat<=56, "1 week", 
                                              ifelse(absent$timecat>56 & absent$timecat<=96, "2 weeks", "3 weeks")))))
View(absent)
absent$timecat <- as.factor(absent$timecat)
absent$onehot <- class.ind(absent$timecat)

#Randomizing and Normalizing
absent2 <- absent #creating dummy data frame to work on 
absent2$Absenteeism.time.in.hours <- NULL
absent2$timecat <- NULL
#View(absent2)
set.seed(65)
abs2_random<-absent2[sample(nrow(absent2)),]
abs2_mm<- model.matrix(~.-20, data=abs2_random)
?model.matrix

normalize<-function(x){
  return((x-min(x))/(max(x)-min(x)))
}

abs2_normal<-as.data.frame(lapply(ab2_mm[1:19],normalize))

```

